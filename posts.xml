<?xml version="1.0" encoding="UTF-8"?>
<rss  xmlns:atom="http://www.w3.org/2005/Atom" 
      xmlns:media="http://search.yahoo.com/mrss/" 
      xmlns:content="http://purl.org/rss/1.0/modules/content/" 
      xmlns:dc="http://purl.org/dc/elements/1.1/" 
      version="2.0">
<channel>
<title>Dors-Liu Quan的笔记</title>
<link>https://yourname.github.io/posts.html</link>
<atom:link href="https://yourname.github.io/posts.xml" rel="self" type="application/rss+xml"/>
<description></description>
<generator>quarto-1.5.57</generator>
<lastBuildDate>Fri, 29 Aug 2025 00:00:00 GMT</lastBuildDate>
<item>
  <title>Adam Optimizer</title>
  <link>https://yourname.github.io/posts/DeepSeek-R1.html</link>
  <description><![CDATA[ 




<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://yourname.github.io/images/maomao3.png" class="img-fluid figure-img"></p>
<figcaption>猫猫镇楼</figcaption>
</figure>
</div>
<p>这篇博文是讲Deepseek-R1的一些特别结论</p>
<section id="代码数学训练集应该先训练" class="level1">
<h1>代码数学训练集应该先训练</h1>
<p>实验证明，先做代码训练再做数学训练，比从通用 LLM 开始更有利于推理能力</p>
</section>
<section id="统一范式" class="level1">
<h1>统一范式</h1>
<p>他们把 SFT、RFT、DPO、PPO、GRPO 放到一个统一框架下看待，强调这些方法本质上都是“简化版的 RL”</p>
</section>
<section id="强化学习-rl-在做什么" class="level1">
<h1>强化学习 (RL) 在做什么</h1>
<p>RL 的作用更多是让输出分布更稳定，把正确答案更容易排在 Top-K，而不是提升“基本能力”</p>


</section>

 ]]></description>
  <category>RL</category>
  <category>Optimizer</category>
  <guid>https://yourname.github.io/posts/DeepSeek-R1.html</guid>
  <pubDate>Fri, 29 Aug 2025 00:00:00 GMT</pubDate>
</item>
<item>
  <title>Muon Optimizer</title>
  <link>https://yourname.github.io/posts/muon_muonclip.html</link>
  <description><![CDATA[ 




<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://yourname.github.io/images/maomao2.png" class="img-fluid figure-img"></p>
<figcaption>猫猫镇楼</figcaption>
</figure>
</div>
<p>这篇博文是讲Muon优化器，Adaptive Moment Estimation</p>
<ul>
<li><p>你可能收获：一种新的optimzer的原理</p></li>
<li><p>你很难收获：实践中的应用结果</p></li>
</ul>
<section id="muon-optimizer" class="level1">
<h1>Muon Optimizer</h1>
<p><strong>Motivation</strong>：把原始梯度矩阵换成一个正交阵 <strong>方法</strong>：应用Newton-Schulz matrix iteration <strong>优势</strong>： - 不用做SVD分解，很方便 - 当前的updates matrics呈现出low-rank matrices，此方法可以增加多样性（和我之前研究相符、值得进一步研究）</p>
<section id="newton-method切线找根" class="level2">
<h2 class="anchored" data-anchor-id="newton-method切线找根">Newton Method：切线找根</h2>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://yourname.github.io/images/newton_method.png" class="img-fluid figure-img" style="width:60.0%"></p>
<figcaption>Newton_Method</figcaption>
</figure>
</div>
</section>
<section id="newton-schulz-method牛顿法的矩阵类似" class="level2">
<h2 class="anchored" data-anchor-id="newton-schulz-method牛顿法的矩阵类似">Newton-Schulz Method：牛顿法的矩阵类似</h2>
<p><strong>Motivation</strong>：把原本的矩阵逐渐迭代成正交阵 <strong>一次迭代</strong>： <img src="https://latex.codecogs.com/png.latex?%0A%5Cbegin%7Baligned%7D%0AG'%20&amp;:=%20aG%20+%20b(GG%5E%5Ctop)G%20+%20c(GG%5E%5Ctop)%5E2%20G%20%5C%5C%0A%20%20%20&amp;=%20(aI%20+%20b(GG%5E%5Ctop)%20+%20c(GG%5E%5Ctop)%5E2)G%20%5C%5C%0A%20%20%20&amp;=%20(aI%20+%20bUS%5E2U%5E%5Ctop%20+%20cUS%5E4U%5E%5Ctop)USV%5E%5Ctop%20%5C%5C%0A%20%20%20&amp;=%20U(aS%20+%20bS%5E3%20+%20cS%5E5)V%5E%5Ctop%0A%5Cend%7Baligned%7D%0A"></p>
<p>其中第二行到第三行应用了SVD分解 <strong>原理</strong>：中间的奇异值S逐渐趋近于1 <img src="https://yourname.github.io/images/newton_schulz_method.png" class="img-fluid" style="width:60.0%" alt="Newton_Method"></p>
</section>
<section id="muon-optimizer-1" class="level2">
<h2 class="anchored" data-anchor-id="muon-optimizer-1">Muon Optimizer</h2>
<div class="sourceCode" id="cb1" style="background: #f1f3f5;"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><span class="co" style="color: #5E5E5E;
background-color: null;
font-style: inherit;"># Pytorch code</span></span>
<span id="cb1-2"><span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">def</span> newtonschulz5(G, steps<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">5</span>, eps<span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">1e-7</span>):</span>
<span id="cb1-3">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">assert</span> G.ndim <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">==</span> <span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">2</span></span>
<span id="cb1-4">    a, b, c <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> (<span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">3.4445</span>, <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-</span><span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">4.7750</span>, <span class="fl" style="color: #AD0000;
background-color: null;
font-style: inherit;">2.0315</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">------------------------&gt;</span> 满足条件二</span>
<span id="cb1-5">    X <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> G.bfloat16()</span>
<span id="cb1-6">    X <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">/=</span> (X.norm() <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> eps)  <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">-------------------------------------&gt;</span> 满足条件一</span>
<span id="cb1-7">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> G.size(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> G.size(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>):</span>
<span id="cb1-8">        X <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> X.T</span>
<span id="cb1-9">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">for</span> _ <span class="kw" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">in</span> <span class="bu" style="color: null;
background-color: null;
font-style: inherit;">range</span>(steps):</span>
<span id="cb1-10">        A <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> X <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">@</span> X.T</span>
<span id="cb1-11">        B <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> b <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> A <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> c <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> A <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">@</span> A</span>
<span id="cb1-12">        X <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> a <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">*</span> X <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">+</span> B <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">@</span> X</span>
<span id="cb1-13">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">if</span> G.size(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">0</span>) <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">&gt;</span> G.size(<span class="dv" style="color: #AD0000;
background-color: null;
font-style: inherit;">1</span>):</span>
<span id="cb1-14">        X <span class="op" style="color: #5E5E5E;
background-color: null;
font-style: inherit;">=</span> X.T</span>
<span id="cb1-15">    <span class="cf" style="color: #003B4F;
background-color: null;
font-weight: bold;
font-style: inherit;">return</span> X</span></code></pre></div>
<p><strong>应用上述Newton-Schulz的充分条件</strong>：</p>
<ul>
<li><p>初始G的奇异值范围在[0,1]之间，所以每次会除以F范数</p></li>
<li><p>当N趋于1时，(phi(x))^N趋于1，所以需要选择合适的a、b、c</p></li>
</ul>
<p><strong>完整算法</strong></p>
<ul>
<li><p>第四行：加momentum</p></li>
<li><p>第五行：正交化</p></li>
</ul>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Algorithm Muon
</div>
</div>
<div class="callout-body-container callout-body">
<p><strong>Require:</strong> Learning rate <img src="https://latex.codecogs.com/png.latex?%5Ceta">, momentum <img src="https://latex.codecogs.com/png.latex?%5Cmu"></p>
<ol type="1">
<li>Initialize <img src="https://latex.codecogs.com/png.latex?B_0%20%5Cgets%200"><br>
</li>
<li>For <img src="https://latex.codecogs.com/png.latex?t%20=%201,%20%5Cdots"> do
<ul>
<li>Compute <img src="https://latex.codecogs.com/png.latex?G_t%20%5Cgets%20%5Cnabla_%5Ctheta%20%5Cmathcal%7BL%7D_t(%5Ctheta_%7Bt-1%7D)"><br>
</li>
<li><img src="https://latex.codecogs.com/png.latex?B_t%20%5Cgets%20%5Cmu%20B_%7Bt-1%7D%20+%20G_t"><br>
</li>
<li><img src="https://latex.codecogs.com/png.latex?O_t%20%5Cgets%20%5Ctext%7BNewtonSchulz5%7D(B_t)"><br>
</li>
<li>Update <img src="https://latex.codecogs.com/png.latex?%5Ctheta_t%20%5Cgets%20%5Ctheta_%7Bt-1%7D%20-%20%5Ceta%20O_t"><br>
</li>
</ul></li>
<li>return <img src="https://latex.codecogs.com/png.latex?%5Ctheta_t"></li>
</ol>
</div>
</div>
</section>
</section>
<section id="muonclip-optimizer" class="level1">
<h1>MuonClip Optimizer</h1>
<p><strong>Motivation</strong>：直接修改更新后的<img src="https://latex.codecogs.com/png.latex?W_q">$W_k$参数矩阵。这一步与之前的操作无关。</p>
<p><strong>qk-clip 技术</strong>：放缩Q、K矩阵，将两个矩阵的范数控制在一定范围内。：</p>
<p><img src="https://latex.codecogs.com/png.latex?%0Aq_i%20=%20%5Ceta%5E%5Calpha%20W_q%20x_i,%20%5Cquad%20k_i%20=%20%5Ceta%5E%7B1-%5Calpha%7D%20W_k%20x_i%0A"></p>
<p>其中 <img src="https://latex.codecogs.com/png.latex?%5Calpha"> 为平衡Q与K的超参：</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A(%5Ceta%5E%5Calpha%20q_i)%5E%5Ctop%20(%5Ceta%5E%7B1-%5Calpha%7D%20k_j)%20=%20%5Ceta%20q_i%5E%5Ctop%20k_j%0A"></p>
<p>自适应因子 <img src="https://latex.codecogs.com/png.latex?%5Ceta">（阈值 <img src="https://latex.codecogs.com/png.latex?t">）在每步根据最大值：</p>
<p><img src="https://latex.codecogs.com/png.latex?%0A%5Ceta%20=%20%5Cmin%5Cleft(%5Cfrac%7Bt%7D%7B%5Cmax_%7Bi,j%7D(q_i%5E%5Ctop%20k_j)%7D,1%5Cright)%0A"></p>
<p>其中 <img src="https://latex.codecogs.com/png.latex?t"> 是超参。</p>
</section>
<section id="关于正交化的讨论" class="level1">
<h1>关于正交化的讨论</h1>
<p><strong>muon观察到</strong>：用SGD-momentum and Adam更新时得到的梯度矩阵大都是high condition number，也就是最大奇异值和最小奇异值的比值很大。换句话说，可以近似地将梯度矩阵看成一个低秩矩阵，low-rank matrices。</p>
<p>我的上次实验： <img src="https://yourname.github.io/images/FLowLens.png" class="img-fluid" alt="FLowLens"></p>
</section>
<section id="来源" class="level1">
<h1>来源</h1>
<ul>
<li>muon: https://kellerjordan.github.io/posts/muon/</li>
<li>muonclip: https://moonshotai.github.io/Kimi-K2/</li>
</ul>


</section>

 ]]></description>
  <category>RL</category>
  <category>Optimizer</category>
  <guid>https://yourname.github.io/posts/muon_muonclip.html</guid>
  <pubDate>Thu, 28 Aug 2025 00:00:00 GMT</pubDate>
</item>
<item>
  <title>Adam Optimizer</title>
  <link>https://yourname.github.io/posts/adam.html</link>
  <description><![CDATA[ 




<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://yourname.github.io/images/maomao1.png" class="img-fluid figure-img"></p>
<figcaption>猫猫镇楼</figcaption>
</figure>
</div>
<p>这篇博文是讲Adam优化器，Adaptive Moment Estimation</p>
<section id="基本介绍" class="level1">
<h1>基本介绍</h1>
<p><strong>核心想法</strong>：Adam是针对每一个参数更新的，用一阶矩和二阶矩更新。</p>
<p>公式为：</p>
<p><img src="https://latex.codecogs.com/png.latex?%5Ctheta_t%20=%20%5Ctheta_%7Bt-1%7D%20-%20%5Ceta%20%5Ccdot%20%5Cfrac%7B%5Chat%7Bm_t%7D%7D%7B%5Csqrt%7B%5Chat%7Bv_t%7D%7D%20+%20%5Cepsilon%7D"></p>
<ul>
<li><p>一阶矩（动量）更新： <img src="https://latex.codecogs.com/png.latex?m_t%20=%20%5Cbeta_1%20m_%7Bt-1%7D%20+%20(1-%5Cbeta_1)%20g_t,%20%5Cquad%20m_0%20=%200"></p></li>
<li><p>二阶矩（方差）更新： <img src="https://latex.codecogs.com/png.latex?v_t%20=%20%5Cbeta_2%20v_%7Bt-1%7D%20+%20(1-%5Cbeta_2)%20g_t%5E2,%20%5Cquad%20v_0%20=%200"></p></li>
<li><p>偏差校正： <img src="https://latex.codecogs.com/png.latex?%5Chat%7Bm_t%7D%20=%20%5Cfrac%7Bm_t%7D%7B1-%5Cbeta_1%5Et%7D,%20%5Cquad%20%5Chat%7Bv_t%7D%20=%20%5Cfrac%7Bv_t%7D%7B1-%5Cbeta_2%5Et%7D"></p></li>
</ul>
<p>符号说明：</p>
<ul>
<li><p>梯度： <img src="https://latex.codecogs.com/png.latex?g_t"></p></li>
<li><p>超参（意味着与核心公式无关）： <img src="https://latex.codecogs.com/png.latex?%5Ceta,%20%5Cepsilon,%20%5Cbeta_1,%20%5Cbeta_2"></p></li>
</ul>
</section>
<section id="感性理解" class="level1">
<h1>感性理解</h1>
<ul>
<li>一阶矩控制更新方向，二阶矩控制更新速度</li>
<li>一阶矩<img src="https://latex.codecogs.com/png.latex?m_t">也是一种梯度，是过往梯度的“融合”。<img src="https://latex.codecogs.com/png.latex?%5Cbeta_1">一般设做<img src="https://latex.codecogs.com/png.latex?0.9">，所以每次计算的新梯度都以10%的作用生效，然后逐渐递减</li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="https://yourname.github.io/images/adam_gradient_explain.png" class="img-fluid figure-img"></p>
<figcaption>梯度在更新中的贡献</figcaption>
</figure>
</div>


</section>

 ]]></description>
  <category>RL</category>
  <category>Optimizer</category>
  <guid>https://yourname.github.io/posts/adam.html</guid>
  <pubDate>Wed, 27 Aug 2025 00:00:00 GMT</pubDate>
</item>
</channel>
</rss>
